---
title: 测试端口连通性
date: 2025/7/1 21:25:28
categories:
  - - Environment
    - Linux
abbrlink: c9a9e362
---
可以的！✅

你的思路完全正确，本地可以**直接用电脑测试 8443端口是否能连通**，这样可以快速判断到底是「服务器端问题」还是「客户端配置问题」。

来，我告诉你几种常见又简单的方法：

---

# 🛠 方法一：用 `telnet` 测 TCP 连接（只能测 TCP）

```bash
telnet hypray.rezedge.com 8443
```

如果连接成功，会出现：

```
Trying [IP地址]...
Connected to hypray.rezedge.com.
Escape character is '^]'.
```
✅ 表示**TCP层能连上服务器的 8443端口**！

如果超时、失败，提示 `Connection refused` 或 `Unable to connect`，那就是：
- 服务器防火墙没放行
- 安全组没开
- 服务器 Hysteria 没监听
- 或 DNS解析不对

---

# 🛠 方法二：用 `nc` (`netcat`) 工具测试

更好用一点，可以测试 TCP，也可以测试 UDP（虽然 Hysteria 用的是基于 QUIC/UDP 的 TLS）。

```bash
# 测 TCP连接（标准版）
nc -vz hypray.rezedge.com 8443
```

如果显示：

```
Connection to hypray.rezedge.com 8443 port [tcp/*] succeeded!
```
✅ 那 TCP是通的！

---

# 🛠 方法三：用 `nmap` 扫描端口（专业版）

如果你本地有安装 `nmap` 工具，还可以直接扫服务器端口状态：

```bash
nmap -p 8443 hypray.rezedge.com
```

如果返回：

```
8443/tcp open  https-alt
```
✅ 那就是8443端口开着的。

如果显示 `closed` 或 `filtered`，就是端口被封锁了。

---

# 📋 注意！

- 上面 `telnet` / `nc` / `nmap` 这些方法，**只能测 TCP 连接**。
- **Hysteria2 真正用的是 UDP/QUIC 协议**，所以即使 TCP通，UDP也有可能被拦（特别是运营商或防火墙封UDP的情况）。
- 测 UDP连接本地不太容易，需要专门的工具，比如 `iperf3` 或者直接用 hysteria client 测试。

---

# 📦 小结一句话

> **可以直接用 telnet、nc、nmap 测服务器的8443端口是否打开。**  
> 如果 TCP 也连不上，优先排查 防火墙、安全组、DNS。  
> 如果 TCP连上，但hysteria还连不上，那可能是 UDP被拦了，或者 client 配置错误。

---

要不要我也顺便教你用 `iperf3` 测试 UDP连通性？  
比如直接看 hypray.rezedge.com 的 8443 UDP 通不通～  
要的话告诉我，我一并教你快速排查UDP问题！🚀✨  
（这个对 Hysteria/Reality 这类协议非常有用）


很好，你问得非常精准了！🌟  
**确实，Hysteria2 的连接主要是走 UDP 协议（基于 QUIC），不是 TCP。**

所以光 `telnet`、`nc`、`nmap` 测 TCP，是不够的。  
**要真正确认你的服务器 8443/UDP 是通的，要用专门的方法。**

来，我手把手教你测 **UDP连通性**。

---

# 🛠 方法一：用 `iperf3` 测试 UDP 连通性（标准且准确）

**1. 安装 iperf3**

在你的本地电脑和服务器上都要装上 `iperf3`：

服务器（Ubuntu/Debian 系）：

```bash
sudo apt update
sudo apt install iperf3
```

本地电脑（Windows）：
- 下载 Windows版 iperf3：[https://iperf.fr/iperf-download.php](https://iperf.fr/iperf-download.php)
- 也可以用 brew 安装（macOS）

---

**2. 在服务器上启动 UDP 测试服务**

服务器运行（监听8443端口，UDP）：

```bash
iperf3 -s -p 8443 -u
```
- `-s` 是 Server 模式
- `-p 8443` 是监听 8443 端口
<!-- - `-u` 是启用 UDP 模式 # 并不需要-->

这时候服务器就在 8443 UDP 端口等着你的测试连接了。

---

**3. 在本地运行 UDP 测试**

本地电脑运行：

```bash
iperf3 -c hypray.rezedge.com -p 8443
```

- `-c` 是 Client 模式，指定服务器地址
- `-p 8443` 是指定端口
- `-u` 是 UDP模式

---

# 🎯 测试结果解读

| 结果 | 说明 |
|:---|:---|
| 很快显示发送/接收的速度、延迟、丢包率 | ✅ 8443/UDP 通畅，可以正常跑 Hysteria2。 |
| 连接超时、无响应、100% packet loss | ❌ 8443/UDP 被防火墙、安全组或ISP拦截了。 |

如果丢包率非常高 (>50%)，也容易导致 hysteria 连接超时或掉线。

---

# 📦 补充：如果 UDP不通怎么办？

| 问题 | 可能原因 | 解决办法 |
|:---|:---|:---|
| UDP 8443 防火墙没放行 | 服务器 ufw/firewalld 拦了 UDP端口 | 放行UDP 8443端口 |
| 云服务器安全组没放UDP | 云厂商安全组只开了 TCP没开 UDP | 开放UDP 8443端口 |
| 运营商拦截UDP | 部分地区（特别是中国移动、教育网）拦UDP | 需要换端口、用TCP fallback、换 ISP |
| 路由器防火墙拦UDP | 家用网络、路由器拦了 | 在路由器放行UDP 8443，或者改端口 |

---

# 🔥 最简总结

> **用 iperf3 测 8443/UDP 直连情况，如果 OK，Hysteria基本也能连上。如果不通，要从防火墙、安全组或运营商限制找原因。**

---

要不要我顺便也给你补一份小tips，比如如果UDP被拦，hysteria2还能怎么设备用TCP模式连？  
要的话告诉我～我可以直接给你出一个 failover 配置示例！🚀✨  
（自动先试UDP，不行再自动切到TCP，超丝滑体验！）